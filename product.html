<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Page</title>
<style>
body{margin:0;padding:0;font-family:Arial,sans-serif;background:#f8f8f8;}
header img#headerImage{width:100%;height:auto;object-fit:cover;}
#slider{width:100%;overflow:hidden;position:relative;margin-top:10px;}
#slider img{width:100%;height:auto;display:none;object-fit:cover;border-radius:8px;}
#slider img.active{display:block;margin-bottom:10px;}
#storageSelect{display:flex;gap:10px;justify-content:center;margin:10px 0;}
#storageSelect button{padding:10px 15px;border:none;border-radius:5px;background:#ddd;cursor:pointer;}
#storageSelect button.active{background:#ff3b3b;color:#fff;}
#productDetail{padding:10px;text-align:center;}
#smallAdminImage{width:50px;height:50px;object-fit:cover;margin:5px auto;border-radius:5px;}
#countdown{background:orange;color:#fff;font-weight:bold;padding:5px 10px;border-radius:5px;display:inline-block;margin:10px 0;text-align:center;width:fit-content;}
#bottomImages{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0;}
#bottomImages img{width:100%;max-width:32%;object-fit:cover;border-radius:8px;}
#actionButtons{position:fixed;bottom:0;width:100%;display:flex;}
#actionButtons button{flex:1;padding:15px;font-size:16px;border:none;cursor:pointer;}
#addCartBtn{background:#ff3b3b;color:#fff;}
#buyNowBtn{background:yellow;color:#000;}
</style>
</head>
<body>

<header>
  <img id="headerImage" src="" alt="Header">
</header>

<div id="slider"></div>

<div id="storageSelect">
  <button data-value="128GB">128GB</button>
  <button data-value="256GB">256GB</button>
  <button data-value="512GB">512GB</button>
  <button data-value="1TB">1TB</button>
</div>

<div id="productDetail"></div>

<img id="smallAdminImage" src="" alt="Admin Small">

<div id="countdown">Time left: <span id="countdownTimer"></span></div>

<div id="bottomImages"></div>

<div id="actionButtons">
  <button id="addCartBtn">Add to Cart</button>
  <button id="buyNowBtn">Buy Now</button>
</div>

<script>
// Get product id from URL
const params = new URLSearchParams(window.location.search);
const productId = params.get('id') || 0;
const productKey = 'product_'+productId+'_';

// Helper to get localStorage JSON
function getStorageItem(key, defaultValue){
  return JSON.parse(localStorage.getItem(key) || JSON.stringify(defaultValue));
}

// Header Image
const headerImage = localStorage.getItem(productKey+'header') || 'https://via.placeholder.com/800x200';
document.getElementById('headerImage').src = headerImage;

// Slider Images
let sliderImages = getStorageItem(productKey+'slider',[
  'https://via.placeholder.com/600x300',
  'https://via.placeholder.com/600x300',
  'https://via.placeholder.com/600x300'
]);
const sliderContainer = document.getElementById('slider');
function renderSlider(){
  sliderContainer.innerHTML = '';
  sliderImages.forEach((img, i)=>{
    const image = document.createElement('img');
    image.src = img;
    if(i===0) image.classList.add('active');
    sliderContainer.appendChild(image);
  });
}
renderSlider();
let currentSlide = 0;
setInterval(()=>{
  const imgs = sliderContainer.querySelectorAll('img');
  if(imgs.length===0) return;
  imgs.forEach(i=>i.classList.remove('active'));
  currentSlide = (currentSlide + 1) % imgs.length;
  imgs[currentSlide].classList.add('active');
},3000);

// Storage Selection
const storageButtons = document.querySelectorAll('#storageSelect button');
let selectedStorage = '128GB';
storageButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    storageButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    selectedStorage = btn.dataset.value;
  });
});
storageButtons[0].classList.add('active'); // default

// Product Detail (from previous page)
const prevProducts = getStorageItem('products',[]);
const product = prevProducts[productId];
const productDetailDiv = document.getElementById('productDetail');
if(product){
  productDetailDiv.innerHTML = `
    <h2>${product.name}</h2>
    <p><del>₹${product.oldPrice}</del> <span style="color:green;">${product.discount}% OFF</span> <strong>₹${product.newPrice}</strong></p>
  `;
}else{
  productDetailDiv.innerHTML = '<p>Product details not found</p>';
}

// Small Admin Image below detail
const smallAdminImg = localStorage.getItem(productKey+'small') || 'https://via.placeholder.com/50';
document.getElementById('smallAdminImage').src = smallAdminImg;

// Countdown
let countdownMinutes = parseInt(localStorage.getItem(productKey+'timerMinutes')||15);
let countdownSeconds = countdownMinutes*60;
const countdownEl = document.getElementById('countdownTimer');
function updateCountdown(){
  let m = Math.floor(countdownSeconds/60);
  let s = countdownSeconds%60;
  countdownEl.innerText = `${m}:${s<10?'0'+s:s}`;
  countdownSeconds--;
  if(countdownSeconds<0) countdownSeconds = 0;
}
updateCountdown();
setInterval(updateCountdown,1000);

// Bottom Images
let bottomImages = getStorageItem(productKey+'bottom',[
  'https://via.placeholder.com/300x150',
  'https://via.placeholder.com/300x150',
  'https://via.placeholder.com/300x150'
]);
const bottomContainer = document.getElementById('bottomImages');
function renderBottomImages(){
  bottomContainer.innerHTML='';
  bottomImages.forEach((img, i)=>{
    const image = document.createElement('img');
    image.src = img;
    image.alt = 'Bottom Image '+i;
    bottomContainer.appendChild(image);
  });
}
renderBottomImages();

// Action Buttons
document.getElementById('addCartBtn').onclick = ()=>{
  window.location.href = 'nextpage.html';
}
document.getElementById('buyNowBtn').onclick = ()=>{
  window.location.href = 'nextpage.html';
}
</script>
</body>
</html>
