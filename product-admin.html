<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Admin Panel</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f0f0;margin:0;padding:0;}
.container{max-width:1200px;margin:auto;padding:20px;background:#fff;}
h1,h2{color:#333;margin-top:0;}
section{margin-bottom:30px;padding:10px;border:1px solid #ccc;border-radius:8px;background:#fafafa;}
label{display:block;margin:5px 0;font-weight:bold;}
input[type=text], input[type=number], input[type=file], select{width:100%;padding:5px;margin-bottom:10px;}
button{padding:7px 12px;margin-right:5px;background:#ff3b3b;color:#fff;border:none;border-radius:5px;cursor:pointer;}
button.delete{background:#555;}
img.preview{width:100px;height:80px;object-fit:cover;margin-right:5px;border:1px solid #ddd;border-radius:5px;}
.flex-row{display:flex;gap:10px;flex-wrap:wrap;}
.flex-row > div{flex:1;}
.item-list{display:flex;align-items:center;margin:5px 0;}
.item-list span{flex:1;margin-left:10px;}
</style>
</head>
<body>
<div class="container">
<h1>Product Admin Panel</h1>

<!-- Select Product -->
<section>
<h2>Select Product</h2>
<select id="productSelect">
  <!-- Generate 100 products -->
  <script>
    for(let i=0;i<100;i++){
      document.write(`<option value="${i}">Product ${i+1}</option>`);
    }
  </script>
</select>
</section>

<!-- Header Image (same for all) -->
<section>
<h2>Header Image (Same for all Products)</h2>
<input type="file" id="headerImageUpload" accept="image/*">
<img id="headerPreview" class="preview" src="">
</section>

<!-- Slider Images -->
<section>
<h2>Slider Images (Multiple)</h2>
<input type="file" id="sliderUpload" accept="image/*" multiple>
<div id="sliderList"></div>
</section>

<!-- Bottom Images -->
<section>
<h2>Bottom Images</h2>
<input type="file" id="bottomUpload" accept="image/*" multiple>
<div id="bottomList"></div>
</section>

<!-- Storage / Size -->
<section>
<h2>Storage / Size Options</h2>
<div id="sizeList"></div>
<input type="text" id="sizeInput" placeholder="Enter new storage / size">
<button id="addSize">Add Size</button>
</section>

<!-- Countdown & Sell Button -->
<section>
<h2>Countdown & Buttons</h2>
<div class="flex-row">
<div>
<label>Countdown Minutes</label>
<input type="number" id="timerMinutesInput" value="15">
<label>Countdown Background Color</label>
<input type="text" id="timerBgInput" placeholder="#FFA500">
</div>
<div>
<label>Sell Button Text</label>
<input type="text" id="sellTextInput" value="Buy Now">
<label>Sell Button Text Color</label>
<input type="text" id="sellTextColorInput" placeholder="#ffffff">
<label>Sell Button Background</label>
<input type="text" id="sellBgColorInput" placeholder="#ff3b3b">
</div>
</div>
</section>

<!-- Save Button -->
<section style="text-align:center;">
<button id="saveAll">Save Product Data</button>
</section>

<script>
// Helper: convert file to base64
function fileToBase64(file, callback){
  const reader = new FileReader();
  reader.onload = function(e){ callback(e.target.result); }
  reader.readAsDataURL(file);
}

// Product Key
function getProductKey(){
  const id = document.getElementById('productSelect').value;
  return 'product_'+id+'_';
}

// ---------------- Header ----------------
const headerPreview = document.getElementById('headerPreview');
function loadHeader(){
  const data = localStorage.getItem('header_global');
  headerPreview.src = data || '';
}
document.getElementById('headerImageUpload').onchange = ()=>{
  const file = document.getElementById('headerImageUpload').files[0];
  if(file){
    fileToBase64(file,(data)=>{
      localStorage.setItem('header_global', data);
      headerPreview.src = data;
    });
  }
}
loadHeader();

// ---------------- Slider ----------------
function renderSlider(){
  const sliderList = document.getElementById('sliderList');
  sliderList.innerHTML='';
  const sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  sliders.forEach((img,i)=>{
    const div = document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<img src="${img}" class="preview"><button class="delete" onclick="deleteSlider(${i})">Delete</button>`;
    sliderList.appendChild(div);
  });
}
function deleteSlider(i){
  let sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  sliders.splice(i,1);
  localStorage.setItem(getProductKey()+'slider',JSON.stringify(sliders));
  renderSlider();
}

// ---------------- Bottom Images ----------------
function renderBottom(){
  const bottomList = document.getElementById('bottomList');
  bottomList.innerHTML='';
  const bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  bottom.forEach((img,i)=>{
    const div = document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<img src="${img}" class="preview"><button class="delete" onclick="deleteBottom(${i})">Delete</button>`;
    bottomList.appendChild(div);
  });
}
function deleteBottom(i){
  let bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  bottom.splice(i,1);
  localStorage.setItem(getProductKey()+'bottom',JSON.stringify(bottom));
  renderBottom();
}

// ---------------- Storage / Size ----------------
function renderSizes(){
  const sizeList = document.getElementById('sizeList');
  sizeList.innerHTML='';
  const sizes = JSON.parse(localStorage.getItem(getProductKey()+'sizes')||'[]');
  sizes.forEach((s,i)=>{
    const div=document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<span>${s}</span><button class="delete" onclick="deleteSize(${i})">Delete</button>`;
    sizeList.appendChild(div);
  });
}
function deleteSize(i){
  let sizes = JSON.parse(localStorage.getItem(getProductKey()+'sizes')||'[]');
  sizes.splice(i,1);
  localStorage.setItem(getProductKey()+'sizes',JSON.stringify(sizes));
  renderSizes();
}
document.getElementById('addSize').onclick = ()=>{
  const val = document.getElementById('sizeInput').value.trim();
  if(val===''){ alert('Enter size'); return;}
  let sizes = JSON.parse(localStorage.getItem(getProductKey()+'sizes')||'[]');
  sizes.push(val);
  localStorage.setItem(getProductKey()+'sizes',JSON.stringify(sizes));
  document.getElementById('sizeInput').value='';
  renderSizes();
}

// ---------------- Countdown & Button ----------------
function loadCountdown(){
  document.getElementById('timerMinutesInput').value = localStorage.getItem(getProductKey()+'timerMinutes')||15;
  document.getElementById('timerBgInput').value = localStorage.getItem(getProductKey()+'timerBg')||'#FFA500';
  document.getElementById('sellTextInput').value = localStorage.getItem(getProductKey()+'sellText')||'Buy Now';
  document.getElementById('sellTextColorInput').value = localStorage.getItem(getProductKey()+'sellTextColor')||'#ffffff';
  document.getElementById('sellBgColorInput').value = localStorage.getItem(getProductKey()+'sellBg')||'#ff3b3b';
}
loadCountdown();

// ---------------- Save All ----------------
document.getElementById('saveAll').onclick = ()=>{
  // Slider
  const sliderFiles = document.getElementById('sliderUpload').files;
  if(sliderFiles.length>0){
    let sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
    let count=0;
    Array.from(sliderFiles).forEach(file=>{
      fileToBase64(file,(data)=>{
        sliders.push(data);
        count++;
        if(count===sliderFiles.length){
          localStorage.setItem(getProductKey()+'slider',JSON.stringify(sliders));
          renderSlider();
        }
      });
    });
  }

  // Bottom
  const bottomFiles = document.getElementById('bottomUpload').files;
  if(bottomFiles.length>0){
    let bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
    let count=0;
    Array.from(bottomFiles).forEach(file=>{
      fileToBase64(file,(data)=>{
        bottom.push(data);
        count++;
        if(count===bottomFiles.length){
          localStorage.setItem(getProductKey()+'bottom',JSON.stringify(bottom));
          renderBottom();
        }
      });
    });
  }

  // Countdown & Button
  localStorage.setItem(getProductKey()+'timerMinutes', document.getElementById('timerMinutesInput').value);
  localStorage.setItem(getProductKey()+'timerBg', document.getElementById('timerBgInput').value);
  localStorage.setItem(getProductKey()+'sellText', document.getElementById('sellTextInput').value);
  localStorage.setItem(getProductKey()+'sellTextColor', document.getElementById('sellTextColorInput').value);
  localStorage.setItem(getProductKey()+'sellBg', document.getElementById('sellBgColorInput').value);

  alert('Product Data Saved Successfully!');
}

// ---------------- Update on Product Select Change ----------------
document.getElementById('productSelect').addEventListener('change', ()=>{
  loadHeader();
  renderSlider();
  renderBottom();
  renderSizes();
  loadCountdown();
});
</script>
</body>
</html>
