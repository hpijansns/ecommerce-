<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Admin Panel</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f0f0;margin:0;padding:0;}
.container{max-width:1200px;margin:auto;padding:20px;background:#fff;}
h1,h2{color:#333;}
section{margin-bottom:30px;padding:10px;border:1px solid #ccc;border-radius:8px;background:#fafafa;}
label{display:block;margin:5px 0;font-weight:bold;}
input[type=text], input[type=number], input[type=file], select{width:100%;padding:5px;margin-bottom:10px;}
button{padding:7px 12px;margin-right:5px;background:#ff3b3b;color:#fff;border:none;border-radius:5px;cursor:pointer;}
button.delete{background:#555;}
img.preview{width:100px;height:80px;object-fit:cover;margin-right:5px;border:1px solid #ddd;border-radius:5px;}
.flex-row{display:flex;gap:10px;flex-wrap:wrap;}
.flex-row > div{flex:1;}
.item-list{display:flex;align-items:center;margin:5px 0;}
.item-list span{flex:1;margin-left:10px;}
</style>
</head>
<body>
<div class="container">
<h1>Product Admin Panel</h1>

<label>Product ID (0,1,2...)</label>
<input type="number" id="productIdInput" value="0">

<!-- Header Image -->
<section>
<h2>Header Image</h2>
<input type="file" id="headerImageUpload" accept="image/*">
<img id="headerPreview" class="preview" src="">
<button id="saveHeader">Save Header</button>
</section>

<!-- Slider Images -->
<section>
<h2>Slider Images (Multiple)</h2>
<input type="file" id="sliderUpload" accept="image/*" multiple>
<div id="sliderList"></div>
<button id="saveSlider">Save Slider</button>
</section>

<!-- Small Admin Image -->
<section>
<h2>Small Admin Image</h2>
<input type="file" id="smallImageUpload" accept="image/*">
<img id="smallPreview" class="preview" src="">
<button id="saveSmallImage">Save Small Image</button>
</section>

<!-- Bottom Images -->
<section>
<h2>Bottom Images</h2>
<input type="file" id="bottomUpload" accept="image/*" multiple>
<div id="bottomList"></div>
<button id="saveBottom">Save Bottom Images</button>
</section>

<!-- Countdown & Sell Button -->
<section>
<h2>Countdown & Buttons</h2>
<div class="flex-row">
<div>
<label>Countdown Minutes</label>
<input type="number" id="timerMinutesInput" value="15">
<label>Countdown Background Color</label>
<input type="text" id="timerBgInput" placeholder="#FFA500">
</div>
<div>
<label>Sell Button Text</label>
<input type="text" id="sellTextInput" value="Buy Now">
<label>Sell Button Text Color</label>
<input type="text" id="sellTextColorInput" placeholder="#ffffff">
<label>Sell Button Background</label>
<input type="text" id="sellBgColorInput" placeholder="#ff3b3b">
</div>
</div>
<button id="saveCountdown">Save Countdown & Button</button>
</section>

</div>

<script>
// Helper: convert file to base64
function fileToBase64(file, callback){
  const reader = new FileReader();
  reader.onload = function(e){ callback(e.target.result); }
  reader.readAsDataURL(file);
}

// Get current product key
function getProductKey(){
  const id = document.getElementById('productIdInput').value;
  return 'product_'+id+'_';
}

// Header
const headerPreview = document.getElementById('headerPreview');
if(localStorage.getItem(getProductKey()+'header')) headerPreview.src = localStorage.getItem(getProductKey()+'header');

document.getElementById('saveHeader').onclick = ()=>{
  const file = document.getElementById('headerImageUpload').files[0];
  if(file){
    fileToBase64(file,(data)=>{
      localStorage.setItem(getProductKey()+'header', data);
      headerPreview.src = data;
      alert('Header Saved');
    });
  }else alert('Select an image');
}

// Slider
function renderSlider(){
  const sliderList = document.getElementById('sliderList');
  sliderList.innerHTML='';
  const sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  sliders.forEach((img,i)=>{
    const div = document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<img src="${img}" class="preview"><button class="delete" onclick="deleteSlider(${i})">Delete</button>`;
    sliderList.appendChild(div);
  });
}
function deleteSlider(i){
  let sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  sliders.splice(i,1);
  localStorage.setItem(getProductKey()+'slider',JSON.stringify(sliders));
  renderSlider();
}
document.getElementById('saveSlider').onclick = ()=>{
  const files = document.getElementById('sliderUpload').files;
  if(files.length===0){ alert('Select images'); return;}
  let sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  let count=0;
  Array.from(files).forEach(file=>{
    fileToBase64(file,(data)=>{
      sliders.push(data);
      count++;
      if(count===files.length){
        localStorage.setItem(getProductKey()+'slider',JSON.stringify(sliders));
        renderSlider();
        alert('Slider Saved');
      }
    });
  });
}
renderSlider();

// Small Admin Image
const smallPreview = document.getElementById('smallPreview');
if(localStorage.getItem(getProductKey()+'small')) smallPreview.src = localStorage.getItem(getProductKey()+'small');
document.getElementById('saveSmallImage').onclick = ()=>{
  const file = document.getElementById('smallImageUpload').files[0];
  if(file){
    fileToBase64(file,(data)=>{
      localStorage.setItem(getProductKey()+'small', data);
      smallPreview.src = data;
      alert('Small Image Saved');
    });
  }else alert('Select an image');
}

// Bottom Images
function renderBottom(){
  const bottomList = document.getElementById('bottomList');
  bottomList.innerHTML='';
  const bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  bottom.forEach((img,i)=>{
    const div = document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<img src="${img}" class="preview"><button class="delete" onclick="deleteBottom(${i})">Delete</button>`;
    bottomList.appendChild(div);
  });
}
function deleteBottom(i){
  let bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  bottom.splice(i,1);
  localStorage.setItem(getProductKey()+'bottom',JSON.stringify(bottom));
  renderBottom();
}
document.getElementById('saveBottom').onclick = ()=>{
  const files = document.getElementById('bottomUpload').files;
  if(files.length===0){ alert('Select images'); return;}
  let bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  let count=0;
  Array.from(files).forEach(file=>{
    fileToBase64(file,(data)=>{
      bottom.push(data);
      count++;
      if(count===files.length){
        localStorage.setItem(getProductKey()+'bottom',JSON.stringify(bottom));
        renderBottom();
        alert('Bottom Images Saved');
      }
    });
  });
}
renderBottom();

// Countdown & Button
document.getElementById('saveCountdown').onclick = ()=>{
  localStorage.setItem(getProductKey()+'timerMinutes', document.getElementById('timerMinutesInput').value);
  localStorage.setItem(getProductKey()+'timerBg', document.getElementById('timerBgInput').value);
  localStorage.setItem(getProductKey()+'sellText', document.getElementById('sellTextInput').value);
  localStorage.setItem(getProductKey()+'sellTextColor', document.getElementById('sellTextColorInput').value);
  localStorage.setItem(getProductKey()+'sellBg', document.getElementById('sellBgColorInput').value);
  alert('Countdown & Button Saved');
}

// Update preview when product ID changes
document.getElementById('productIdInput').addEventListener('change', ()=>{
  renderSlider();
  renderBottom();
  if (localStorage.getItem(getProductKey()+'header')) headerPreview.src = localStorage.getItem(getProductKey()+'header');
  else headerPreview.src = '';
  
  if(localStorage.getItem(getProductKey()+'small')) smallPreview.src = localStorage.getItem(getProductKey()+'small');
  else smallPreview.src = '';
});
</script>
</body>
</html>
