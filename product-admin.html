<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Admin Panel</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f0f0;margin:0;padding:0;}
.container{max-width:1200px;margin:auto;padding:20px;background:#fff;}
h2{margin-top:0;color:#333;}
section{margin-bottom:30px;padding:10px;border:1px solid #ccc;border-radius:8px;background:#fafafa;}
label{display:block;margin:5px 0;font-weight:bold;}
input[type=text], input[type=number], input[type=file], select{width:100%;padding:5px;margin-bottom:10px;}
button{padding:7px 12px;margin-right:5px;background:#ff3b3b;color:#fff;border:none;border-radius:5px;cursor:pointer;}
button.delete{background:#555;}
img.preview{width:100px;height:80px;object-fit:cover;margin-right:5px;border:1px solid #ddd;border-radius:5px;}
.flex-row{display:flex;gap:10px;flex-wrap:wrap;}
.flex-row > div{flex:1;}
.item-list{display:flex;align-items:center;margin:5px 0;}
.item-list span{flex:1;margin-left:10px;}
</style>
</head>
<body>
<div class="container">
<h1>Product Admin Panel</h1>

<label>Product ID (0,1,2...)</label>
<input type="number" id="productIdInput" value="0">

<!-- Header Image -->
<section>
<h2>Header Image</h2>
<input type="file" id="headerImageUpload" accept="image/*">
<img id="headerPreview" class="preview" src="">
<button id="saveHeader">Save Header</button>
</section>

<!-- Slider Images -->
<section>
<h2>Slider Images (Multiple)</h2>
<input type="file" id="sliderUpload" accept="image/*" multiple>
<div id="sliderList"></div>
<button id="saveSlider">Save Slider</button>
</section>

<!-- Product Main Image -->
<section>
<h2>Product Main Image</h2>
<input type="file" id="productImageUpload" accept="image/*">
<img id="productPreview" class="preview" src="">
<button id="saveProductImage">Save Product Image</button>
</section>

<!-- Bottom 3 Images -->
<section>
<h2>Bottom Images</h2>
<input type="file" id="bottomUpload" accept="image/*" multiple>
<div id="bottomList"></div>
<button id="saveBottom">Save Bottom Images</button>
</section>

<!-- Countdown & Sell Button -->
<section>
<h2>Countdown & Buttons</h2>
<div class="flex-row">
<div>
<label>Countdown Minutes</label>
<input type="number" id="timerMinutesInput" value="20">
<label>Countdown Background Color</label>
<input type="text" id="timerBgInput" placeholder="#FFA500">
</div>
<div>
<label>Sell Button Text</label>
<input type="text" id="sellTextInput" value="Buy Now">
<label>Sell Button Text Color</label>
<input type="text" id="sellTextColorInput" placeholder="#ffffff">
<label>Sell Button Background</label>
<input type="text" id="sellBgColorInput" placeholder="#ff3b3b">
</div>
</div>
<button id="saveCountdown">Save Countdown & Button</button>
</section>

</div>

<script>
// Convert file to base64
function fileToBase64(file){ 
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.onload = e=>resolve(e.target.result);
    reader.onerror = e=>reject(e);
    reader.readAsDataURL(file);
  });
}

// Get current product key
function getProductKey(){ return 'product_'+document.getElementById('productIdInput').value+'_' }

// Load previews
function loadPreviews(){
  const key = getProductKey();
  document.getElementById('headerPreview').src = localStorage.getItem(key+'header') || '';
  document.getElementById('productPreview').src = localStorage.getItem(key+'main') || '';
  renderSlider();
  renderBottom();
}

// HEADER
document.getElementById('saveHeader').onclick = async ()=>{
  const file = document.getElementById('headerImageUpload').files[0];
  if(!file){ alert('Select an image'); return; }
  const data = await fileToBase64(file);
  localStorage.setItem(getProductKey()+'header',data);
  document.getElementById('headerPreview').src = data;
  alert('Header Saved');
}

// SLIDER
function renderSlider(){
  const list = document.getElementById('sliderList');
  const sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  list.innerHTML='';
  sliders.forEach((img,i)=>{
    const div=document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<img src="${img}" class="preview"><button class="delete" onclick="deleteSlider(${i})">Delete</button>`;
    list.appendChild(div);
  });
}
function deleteSlider(i){
  const sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  sliders.splice(i,1);
  localStorage.setItem(getProductKey()+'slider',JSON.stringify(sliders));
  renderSlider();
}
document.getElementById('saveSlider').onclick = async ()=>{
  const files = document.getElementById('sliderUpload').files;
  if(files.length===0){ alert('Select images'); return; }
  const sliders = JSON.parse(localStorage.getItem(getProductKey()+'slider')||'[]');
  for(const file of files){
    const data = await fileToBase64(file);
    sliders.push(data);
  }
  localStorage.setItem(getProductKey()+'slider',JSON.stringify(sliders));
  renderSlider();
  alert('Slider Saved');
}

// PRODUCT IMAGE
document.getElementById('saveProductImage').onclick = async ()=>{
  const file = document.getElementById('productImageUpload').files[0];
  if(!file){ alert('Select an image'); return; }
  const data = await fileToBase64(file);
  localStorage.setItem(getProductKey()+'main',data);
  document.getElementById('productPreview').src = data;
  alert('Product Image Saved');
}

// BOTTOM IMAGES
function renderBottom(){
  const list = document.getElementById('bottomList');
  const bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  list.innerHTML='';
  bottom.forEach((img,i)=>{
    const div=document.createElement('div');
    div.className='item-list';
    div.innerHTML=`<img src="${img}" class="preview" style="width:100%;height:auto;"><button class="delete" onclick="deleteBottom(${i})">Delete</button>`;
    list.appendChild(div);
  });
}
function deleteBottom(i){
  const bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  bottom.splice(i,1);
  localStorage.setItem(getProductKey()+'bottom',JSON.stringify(bottom));
  renderBottom();
}
document.getElementById('saveBottom').onclick = async ()=>{
  const files = document.getElementById('bottomUpload').files;
  if(files.length===0){ alert('Select images'); return; }
  const bottom = JSON.parse(localStorage.getItem(getProductKey()+'bottom')||'[]');
  for(const file of files){
    const data = await fileToBase64(file);
    bottom.push(data);
  }
  localStorage.setItem(getProductKey()+'bottom',JSON.stringify(bottom));
  renderBottom();
  alert('Bottom Images Saved');
}

// COUNTDOWN & BUTTON
document.getElementById('saveCountdown').onclick = ()=>{
  const key = getProductKey();
  localStorage.setItem(key+'timerMinutes', document.getElementById('timerMinutesInput').value);
  localStorage.setItem(key+'timerBg', document.getElementById('timerBgInput').value);
  localStorage.setItem(key+'sellText', document.getElementById('sellTextInput').value);
  localStorage.setItem(key+'sellTextColor', document.getElementById('sellTextColorInput').value);
  localStorage.setItem(key+'sellBg', document.getElementById('sellBgColorInput').value);
  alert('Countdown & Button Saved');
}

// UPDATE ON PRODUCT ID CHANGE
document.getElementById('productIdInput').addEventListener('change',loadPreviews);

// INITIAL LOAD
loadPreviews();
</script>
</body>
</html>
